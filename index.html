<!DOCTYPE html>
<html>
<head>
    <title>Active Permits & L Train Alternate Service</title>
    <meta charset="utf-8" />
	<link rel="stylesheet" href="leaflet.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="style2.css" type="text/css" media="screen" />	
</head>
<style>
html,
body {
	height: 100%
}

#map {
	height: 100%
}

.ui {
	top: 10px;
	left: 50px;
	padding: 8px;
	position: absolute;
	background-color: #fff;
	border: 2px solid #707070;
	border-radius: 7px;
	width: 300px;
}
.NB-div-icon {
	background: #FF5500;
	opacity: 0.7;
}
.A1Enl-div-icon {
	background: #42d4f4;
	opacity: 0.7;
}
.A1-div-icon {
	background: #ce8e8e;
	opacity: 0.7;
}
.A2-div-icon {
	background: #bcb92f;
	opacity: 0.7;
}
.DM-div-icon {
	background: #80f442;
	opacity: 0.7;
}
</style>
<body>
	<div id="map">
		<div id="ui-container" class="ui" style="z-index: 401">
		
			      <h4>Active Permits</h4>
				  <h5>(Within 300 Feet of L Train Alternate Route)</h5>
				  
				  <span style="display:inline-block; background-color:#FF5500; padding:0px; margin:0px; height:13px; width:13px; overflow:hidden"><input type="checkbox" style="opacity:0.50;padding:0px;margin:0px" name="permit" class="regular-checkbox" value="nb" id="nb" checked="checked"/></span>
					<label for="nb"></label><span class="en">NB</span>
				  <br/>
				  
				  <span style="display:inline-block; background-color:#42d4f4; padding:0px; margin:0px; height:13px; width:13px; overflow:hidden"><input type="checkbox" style="opacity:0.50;padding:0px;margin:0px" name="permit" class="regular-checkbox" value="a1enl" id="a1enl" checked="checked" /></span>
					<label for="a1"></label><span class="en">A1 Enlargement</span>
				  <br/>
				  
				  <span style="display:inline-block; background-color:#ce8e8e; padding:0px; margin:0px; height:13px; width:13px; overflow:hidden"><input type="checkbox" style="opacity:0.50;padding:0px;margin:0px" name="permit" class="regular-checkbox" value="a1" id="a1"/></span>
					<label for="nb"></label><span class="en">A1</span>
				  <br/>
				  
				  <span style="display:inline-block; background-color:#bcb92f; padding:0px; margin:0px; height:13px; width:13px; overflow:hidden"><input type="checkbox" style="opacity:0.50;padding:0px;margin:0px" name="permit" class="regular-checkbox" value="a2" id="a2"/></span>
					<label for="a1"></label><span class="en">A2</span>
				  <br/>

				  <span style="display:inline-block; background-color:#80f442; padding:0px; margin:0px; height:13px; width:13px; overflow:hidden"><input type="checkbox" style="opacity:0.50;padding:0px;margin:0px" name="permit" class="regular-checkbox" value="dm" id="dm"/></span>
					<label for="a1"></label><span class="en">DM</span>
				  <br/>
				  
				<hr/>

				<h4>Job Filings (2018 YTD)</h4>
				<h5>(Within 300 Feet of L Train Alternate Route)</h5>

				<span style="display:inline-block; background-color:#FF5500; padding:0px; margin:0px; height:13px; width:13px; overflow:hidden"><input type="checkbox" style="opacity:0.50;padding:0px;margin:0px" name="permit" class="regular-checkbox" value="jfil_nb" id="jfil_nb"/></span>
					<label for="jfil_nb"></label><span class="en">NB</span>	
				<br/>

				<span style="display:inline-block; background-color:#42d4f4; padding:0px; margin:0px; height:13px; width:13px; overflow:hidden"><input type="checkbox" style="opacity:0.50;padding:0px;margin:0px" name="permit" class="regular-checkbox" value="jfil_a1enl" id="jfil_a1enl"/></span>
					<label for="jfil_a1enl"></label><span class="en">A1 Enlargement</span>	
				<br/>
				  
				<span style="display:inline-block; background-color:#ce8e8e; padding:0px; margin:0px; height:13px; width:13px; overflow:hidden"><input type="checkbox" style="opacity:0.50;padding:0px;margin:0px" name="permit" class="regular-checkbox" value="jfil_a1" id="jfil_a1"/></span>
					<label for="jfil_a1"></label><span class="en">A1</span>	
				<br/> 
				
				<span style="display:inline-block; background-color:#bcb92f; padding:0px; margin:0px; height:13px; width:13px; overflow:hidden"><input type="checkbox" style="opacity:0.50;padding:0px;margin:0px" name="permit" class="regular-checkbox" value="jfil_a2" id="jfil_a2"/></span>
					<label for="jfil_a2"></label><span class="en">A2</span>	
				<br/> 
				
				<span style="display:inline-block; background-color:#80f442; padding:0px; margin:0px; height:13px; width:13px; overflow:hidden"><input type="checkbox" style="opacity:0.50;padding:0px;margin:0px" name="permit" class="regular-checkbox" value="jfil_dm" id="jfil_dm"/></span>
					<label for="jfil_dm"></label><span class="en">DM</span>	
				<br/>
				
		</div>
	</div>

	
	<script src="http://d3js.org/d3.v3.min.js"></script>
	<script src="./js/leaflet.js"></script>
	<script src="./js/leaflet.ajax.min.js"></script>
	<script src="jquery-2.1.1.min.js"></script>
	<script src="static/chroniton.js"></script>
	<link href="static/chroniton.css" rel="stylesheet">
	
	<link href="build/nv.d3.css" rel="stylesheet" type="text/css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.2/d3.min.js" charset="utf-8"></script>
    <script src="build/nv.d3.js"></script>
	
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	
    <script>

		var map = L.map('map').setView([40.727057, -73.971895], 14);
		var toolserver = L.tileLayer('http://{s}.www.toolserver.org/tiles/bw-mapnik/{z}/{x}/{y}.png');
		var stamen = L.tileLayer('http://stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}.png', {attribution: 'Â© <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'}).addTo(map); /*Stamen.TonerLite*/
			
		//map.scrollWheelZoom.disable();

		var NB = 0;
			A1Enl = 0;
			A1 = 0;
			A2 = 0;
			DM = 0;
			JFIL_NB = 0;
			JFIL_A1ENL = 0;
			JFIL_A1 = 0;
			JFIL_A2 = 0;
			JFIL_DM = 0;
		
	function init() {
	
		$.getJSON("data/LTrainAltRoute.json")
				.done(function(data) {
					var myStyle = {
						"color": "#a00303",
						"weight": 2,
						"opacity": 0.8
					}
					route = L.geoJson(data, {
						style: myStyle

					}).addTo(map);

				})
		
		$.getJSON("data/ActivePermits_NB_300ft_071618.json")
				.done(function(data) {
					NB = L.geoJson(data, {
						pointToLayer: function (feature, latlng) {
					var prop = feature.properties;
					var popupContent = "<b><i>ACTIVE PERMIT:</i></b> <br>" +
									"<u> ADDRESS </u> <br>" + 
									"<b>" + prop.Address + ", " + prop.Borough_Na + "</b>" +
									"<br> <u> BIN </u> <br> "+ "<b>"+prop.BIN_Number+"</b>" +
									"<br> <u> JOB TYPE </u> <br> "+ "<b>"+prop.Job_Type+"</b>" +
									"<br> <u> JOB NUMBER </u> <br> "+ "<b>" +prop.Job_Number+"</b>" +
									"<br> <u> NUMBER OF STORIES </u> <br> "+ "<b>" +prop.Proposed_S+"</b>" +
									"<br> <u> TOTAL SQUARE FOOTAGE </u> <br> "+"<b>"+prop.Total_Cons+"</b>";
						
							return L.circleMarker (latlng, {
								fillColor: "#FF5500",
								weight: 0,
								radius: 4,
								fillOpacity: 0.7

							}).on('click', function(e){
								this.bindPopup(popupContent).openPopup();
							})
							<!-- .on('mouseover', function(e){ -->
								<!-- this.openPopup(); -->
								<!-- this.setStyle({color: "yellow"}); -->
							<!-- }) -->
							<!-- .on('mouseout', function(e){ -->
								<!-- this.closePopup(); -->
								<!-- this.setStyle({color: "#FF5500"}); -->
							<!-- }); -->
						}
					}).addTo(map);

				})
				
		$.getJSON("data/ActivePermits_A1enl_300ft_071618.json")
				.done(function(data) {
					A1Enl = L.geoJson(data, {
						pointToLayer: function (feature, latlng) {
					var prop = feature.properties;
					var popupContent = "<b><i>ACTIVE PERMIT:</i></b> <br>" +
									"<u> ADDRESS </u> <br>" + 
									"<b>" + prop.Address + ", " + prop.Borough_Na + "</b>" +
									"<br> <u> BIN </u> <br> "+ "<b>"+prop.BIN_Number+"</b>" +
									"<br> <u> JOB TYPE </u> <br> "+ "<b>"+prop.Job_Type+"</b>" +
									"<br> <u> JOB NUMBER </u> <br> "+ "<b>" +prop.Job_Number+"</b>" +
									"<br> <u> NUMBER OF STORIES </u> <br> "+ "<b>" +prop.Proposed_S+"</b>" +
									"<br> <u> ENLARGEMENT SQUARE FOOTAGE </u> <br> "+"<b>"+prop.Enlargem_1+"</b>";
						
							return L.circleMarker (latlng, {
								fillColor: "#42d4f4",
								weight: 0,
								radius: 4,
								fillOpacity: 0.7

							}).on('click', function(e){
								this.bindPopup(popupContent).openPopup();
							})
							<!-- .on('mouseover', function(e){ -->
								<!-- this.openPopup(); -->
								<!-- this.setStyle({color: "yellow"}); -->
							<!-- }) -->
							<!-- .on('mouseout', function(e){ -->
								<!-- this.closePopup(); -->
								<!-- this.setStyle({color: "#FF5500"}); -->
							<!-- }); -->
						}
					}).addTo(map);

				})
				
		$.getJSON("data/ActivePermits_A1_300ft_071618.json")
				.done(function(data) {
					A1 = L.geoJson(data, {
						pointToLayer: function (feature, latlng) {
					var prop = feature.properties;
					var popupContent = "<b><i>ACTIVE PERMIT:</i></b> <br>" +
									"<u> ADDRESS </u> <br>" + 
									"<b>" + prop.Address + ", " + prop.Borough_Na + "</b>" +
									"<br> <u> BIN </u> <br> "+ "<b>"+prop.BIN_Number+"</b>" +
									"<br> <u> JOB TYPE </u> <br> "+ "<b>"+prop.Job_Type+"</b>" +
									"<br> <u> JOB NUMBER </u> <br> "+ "<b>" +prop.Job_Number+"</b>" +
									"<br> <u> NUMBER OF STORIES </u> <br> "+ "<b>" +prop.Proposed_S+"</b>";
						
							return L.circleMarker (latlng, {
								fillColor: "#ce8e8e",
								weight: 0,
								radius: 3,
								fillOpacity: 0.7

							}).on('click', function(e){
								this.bindPopup(popupContent).openPopup();
							})
							<!-- .on('mouseover', function(e){ -->
								<!-- this.openPopup(); -->
								<!-- this.setStyle({color: "yellow"}); -->
							<!-- }) -->
							<!-- .on('mouseout', function(e){ -->
								<!-- this.closePopup(); -->
								<!-- this.setStyle({color: "#FF5500"}); -->
							<!-- }); -->
						}
					})//.addTo(map);

				})
				
		$.getJSON("data/ActivePermits_A2_300ft_071618.json")
				.done(function(data) {
					A2 = L.geoJson(data, {
						pointToLayer: function (feature, latlng) {
					var prop = feature.properties;
					var popupContent = "<b><i>ACTIVE PERMIT:</i></b> <br>" +
									"<u> ADDRESS </u> <br>" + 
									"<b>" + prop.Address + ", " + prop.Borough_Na + "</b>" +
									"<br> <u> BIN </u> <br> "+ "<b>"+prop.BIN_Number+"</b>" +
									"<br> <u> JOB TYPE </u> <br> "+ "<b>"+prop.Job_Type+"</b>" +
									"<br> <u> JOB NUMBER </u> <br> "+ "<b>" +prop.Job_Number+"</b>" +
									"<br> <u> NUMBER OF STORIES </u> <br> "+ "<b>" +prop.Proposed_S+"</b>";
						
							return L.circleMarker (latlng, {
								fillColor: "#bcb92f",
								weight: 0,
								radius: 3,
								fillOpacity: 0.5

							}).on('click', function(e){
								this.bindPopup(popupContent).openPopup();
							})
							<!-- .on('mouseover', function(e){ -->
								<!-- this.openPopup(); -->
								<!-- this.setStyle({color: "yellow"}); -->
							<!-- }) -->
							<!-- .on('mouseout', function(e){ -->
								<!-- this.closePopup(); -->
								<!-- this.setStyle({color: "#FF5500"}); -->
							<!-- }); -->
						}
					})//.addTo(map);

				})
				
		$.getJSON("data/ActivePermits_DM_300ft_071618.json")
				.done(function(data) {
					DM = L.geoJson(data, {
						pointToLayer: function (feature, latlng) {
					var prop = feature.properties;
					var popupContent = "<b><i>ACTIVE PERMIT:</i></b> <br>" +
									"<u> ADDRESS </u> <br>" + 
									"<b>" + prop.Address + ", " + prop.Borough_Na + "</b>" +
									"<br> <u> BIN </u> <br> "+ "<b>"+prop.BIN_Number+"</b>" +
									"<br> <u> JOB TYPE </u> <br> "+ "<b>"+prop.Job_Type+"</b>" +
									"<br> <u> JOB NUMBER </u> <br> "+ "<b>" +prop.Job_Number+"</b>" +
									"<br> <u> NUMBER OF STORIES </u> <br> "+ "<b>" +prop.Existing_S+"</b>";
						
							return L.circleMarker (latlng, {
								fillColor: "#80f442",
								weight: 0,
								radius: 3,
								fillOpacity: 0.7

							}).on('click', function(e){
								this.bindPopup(popupContent).openPopup();
							})
							<!-- .on('mouseover', function(e){ -->
								<!-- this.openPopup(); -->
								<!-- this.setStyle({color: "yellow"}); -->
							<!-- }) -->
							<!-- .on('mouseout', function(e){ -->
								<!-- this.closePopup(); -->
								<!-- this.setStyle({color: "#FF5500"}); -->
							<!-- }); -->
						}
					})//.addTo(map);

				})
		/*		
		$.getJSON("data/JobFilings_010118_041018_300ft.json")
				.done(function(data) {
					JFIL = L.geoJson(data, {
						pointToLayer: function (feature, latlng) {
					var prop = feature.properties;
					var popupContent = "<u> ADDRESS </u> <br>" + 
									"<b>" + prop.Address + ", " + prop.Borough_Na + "</b>" +
									"<br> <u> BIN </u> <br> "+ "<b>"+prop.BIN_Number+"</b>" +
									"<br> <u> JOB TYPE </u> <br> "+ "<b>"+prop.Job_Type+"</b>" +
									"<br> <u> JOB NUMBER </u> <br> "+ "<b>" +prop.Job_Number+"</b>";
						
							return L.circleMarker (latlng, {
								fillColor: "#777777",
								weight: 0,
								radius: 2,
								fillOpacity: 0.7

							}).on('click', function(e){
								this.bindPopup(popupContent).openPopup();
							})
							<!-- .on('mouseover', function(e){ -->
								<!-- this.openPopup(); -->
								<!-- this.setStyle({color: "yellow"}); -->
							<!-- }) -->
							<!-- .on('mouseout', function(e){ -->
								<!-- this.closePopup(); -->
								<!-- this.setStyle({color: "#FF5500"}); -->
							<!-- }); -->
						}
					})//.addTo(map);

				})
				*/
		$.getJSON("data/JobFilings_300ft_010118_071718_NB.json")
				.done(function(data) {
					JFIL_NB = L.geoJson(data, {
						pointToLayer: function (feature, latlng) {
							var prop = feature.properties;
							var popupContent = "<b><i>JOB FILING:</i></b> <br>" +
											"<u> ADDRESS </u> <br>" + 
											"<b>" + prop.Address + ", " + prop.Borough_Na + "</b>" +
											"<br> <u> BIN </u> <br> "+ "<b>"+prop.BIN_Number+"</b>" +
											"<br> <u> JOB TYPE </u> <br> "+ "<b>"+prop.TYPE+"</b>" +
											"<br> <u> JOB NUMBER </u> <br> "+ "<b>" +prop.Job_Number+"</b>";
							var smallIcon = L.DivIcon.extend({
								options: {
									iconSize: [6, 6],
									className: 'NB-div-icon'
								}
							});
							return L.marker(latlng, {
								icon: new smallIcon()
							
								
							}).on('click', function(e){
								this.bindPopup(popupContent).openPopup();
							})
						}
					})//.addTo(map);

				})
		$.getJSON("data/JobFilings_300ft_010118_071718_A1Enl.json")
				.done(function(data) {
					JFIL_A1ENL = L.geoJson(data, {
						pointToLayer: function (feature, latlng) {
							var prop = feature.properties;
							var popupContent = "<b><i>JOB FILING:</i></b> <br>" +
											"<u> ADDRESS </u> <br>" + 
											"<b>" + prop.Address + ", " + prop.Borough_Na + "</b>" +
											"<br> <u> BIN </u> <br> "+ "<b>"+prop.BIN_Number+"</b>" +
											"<br> <u> JOB TYPE </u> <br> "+ "<b>"+prop.TYPE+"</b>" +
											"<br> <u> JOB NUMBER </u> <br> "+ "<b>" +prop.Job_Number+"</b>";
							var smallIcon = L.DivIcon.extend({
								options: {
									iconSize: [6, 6],
									className: 'A1Enl-div-icon'
								}
							});
							return L.marker(latlng, {
								icon: new smallIcon()
							
								
							}).on('click', function(e){
								this.bindPopup(popupContent).openPopup();
							})
						}
					})//.addTo(map);

				})
		$.getJSON("data/JobFilings_300ft_010118_071718_A1.json")
				.done(function(data) {
					JFIL_A1 = L.geoJson(data, {
						pointToLayer: function (feature, latlng) {
							var prop = feature.properties;
							var popupContent = "<b><i>JOB FILING:</i></b> <br>" +
											"<u> ADDRESS </u> <br>" + 
											"<b>" + prop.Address + ", " + prop.Borough_Na + "</b>" +
											"<br> <u> BIN </u> <br> "+ "<b>"+prop.BIN_Number+"</b>" +
											"<br> <u> JOB TYPE </u> <br> "+ "<b>"+prop.TYPE+"</b>" +
											"<br> <u> JOB NUMBER </u> <br> "+ "<b>" +prop.Job_Number+"</b>";
							var smallIcon = L.DivIcon.extend({
								options: {
									iconSize: [6, 6],
									className: 'A1-div-icon'
								}
							});
							return L.marker(latlng, {
								icon: new smallIcon()
							
								
							}).on('click', function(e){
								this.bindPopup(popupContent).openPopup();
							})
						}
					})//.addTo(map);

				})
		$.getJSON("data/JobFilings_300ft_010118_071718_A2.json")
				.done(function(data) {
					JFIL_A2 = L.geoJson(data, {
						pointToLayer: function (feature, latlng) {
							var prop = feature.properties;
							var popupContent = "<b><i>JOB FILING:</i></b> <br>" +
											"<u> ADDRESS </u> <br>" + 
											"<b>" + prop.Address + ", " + prop.Borough_Na + "</b>" +
											"<br> <u> BIN </u> <br> "+ "<b>"+prop.BIN_Number+"</b>" +
											"<br> <u> JOB TYPE </u> <br> "+ "<b>"+prop.TYPE+"</b>" +
											"<br> <u> JOB NUMBER </u> <br> "+ "<b>" +prop.Job_Number+"</b>";
							var smallIcon = L.DivIcon.extend({
								options: {
									iconSize: [4, 4],
									className: 'A2-div-icon'
								}
							});
							return L.marker(latlng, {
								icon: new smallIcon()
							
								
							}).on('click', function(e){
								this.bindPopup(popupContent).openPopup();
							})
						}
					})//.addTo(map);

				})
		$.getJSON("data/JobFilings_300ft_010118_071718_DM.json")
				.done(function(data) {
					JFIL_DM = L.geoJson(data, {
						pointToLayer: function (feature, latlng) {
							var prop = feature.properties;
							var popupContent = "<b><i>JOB FILING:</i></b> <br>" +
											"<u> ADDRESS </u> <br>" + 
											"<b>" + prop.Address + ", " + prop.Borough_Na + "</b>" +
											"<br> <u> BIN </u> <br> "+ "<b>"+prop.BIN_Number+"</b>" +
											"<br> <u> JOB TYPE </u> <br> "+ "<b>"+prop.TYPE+"</b>" +
											"<br> <u> JOB NUMBER </u> <br> "+ "<b>" +prop.Job_Number+"</b>";
							var smallIcon = L.DivIcon.extend({
								options: {
									iconSize: [6, 6],
									className: 'DM-div-icon'
								}
							});
							return L.marker(latlng, {
								icon: new smallIcon()
							
								
							}).on('click', function(e){
								this.bindPopup(popupContent).openPopup();
							})
						}
					})//.addTo(map);

				})
		.fail(function() { alert("There has been a problem loading the data.")});
	}	
		
	function initCheckboxes() {
    var checkboxPermits = $('input.permit:checkbox'),
          $nb = $('#nb'),
		  $a1enl = $('#a1enl'),
          $a1 = $('#a1'),
          $a2 = $('#a2'),
          $dm = $('#dm'),
		  $jfil_nb = $('#jfil_nb'),
		  $jfil_a1enl = $('#jfil_a1enl'),
		  $jfil_a1 = $('#jfil_a1'),
		  $jfil_a2 = $('#jfil_a2'),
		  $jfil_dm = $('#jfil_dm');

		$nb.change(function(){
		  if ($nb.is(':checked')){
			map.addLayer(NB);
		  } else {
			map.removeLayer(NB);
		  };
		});
		
		$a1enl.change(function(){
		  if ($a1enl.is(':checked')){
			map.addLayer(A1Enl);
		  } else {
			map.removeLayer(A1Enl);
		  };
		});
		
		$a1.change(function(){
		  if ($a1.is(':checked')){
			map.addLayer(A1);
		  } else {
			map.removeLayer(A1);
		  };
		});
		
		$a2.change(function(){
		  if ($a2.is(':checked')){
			map.addLayer(A2);
		  } else {
			map.removeLayer(A2);
		  };
		});
		
		$dm.change(function(){
		  if ($dm.is(':checked')){
			map.addLayer(DM);
		  } else {
			map.removeLayer(DM);
		  };
		});
		$jfil_nb.change(function(){
		  if ($jfil_nb.is(':checked')){
			map.addLayer(JFIL_NB);
		  } else {
			map.removeLayer(JFIL_NB);
		  };
		});
		$jfil_a1enl.change(function(){
		  if ($jfil_a1enl.is(':checked')){
			map.addLayer(JFIL_A1ENL);
		  } else {
			map.removeLayer(JFIL_A1ENL);
		  };
		});
		$jfil_a1.change(function(){
		  if ($jfil_a1.is(':checked')){
			map.addLayer(JFIL_A1);
		  } else {
			map.removeLayer(JFIL_A1);
		  };
		});
		$jfil_a2.change(function(){
		  if ($jfil_a2.is(':checked')){
			map.addLayer(JFIL_A2);
		  } else {
			map.removeLayer(JFIL_A2);
		  };
		});
		$jfil_dm.change(function(){
		  if ($jfil_dm.is(':checked')){
			map.addLayer(JFIL_DM);
		  } else {
			map.removeLayer(JFIL_DM);
		  };
		});
	}
	
	
	window.onload = init(); initCheckboxes();
	
    </script>
</body>
</html>
